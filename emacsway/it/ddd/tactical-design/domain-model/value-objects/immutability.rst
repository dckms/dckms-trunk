:canonical-base-url: https://dckms.github.io/system-architecture

.. index::
   single: Immutability; in Value Object
   :name: emacsway-immutability-in-value-object

============
Immutability
============

–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –Ø–ü –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å?
===================================================


–ö–æ–≥–¥–∞ —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å, —Ç–æ —Å—Ç—Ä–∞–Ω—Å—Ç–≤—É—é—â–∏–π Value Object –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è:

    üí¨ –í –ø—Ä–∏–Ω—Ü–∏–ø–µ –¥–≤–∞ –æ–±—ä–µ–∫—Ç–∞ –ß–µ–ª–æ–≤–µ–∫ –º–æ–≥—É—Ç –∏ –Ω–µ –Ω—É–∂–¥–∞—Ç—å—Å—è –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö –æ–±—ä–µ–∫—Ç–∞-–∏–º–µ–Ω–∏.
    –û–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –æ–±—ä–µ–∫—Ç –ò–º—è –º–æ–∂–µ—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–≤—É–º—è –æ–±—ä–µ–∫—Ç–∞–º–∏ –ß–µ–ª–æ–≤–µ–∫ (–≤ –∫–∞–∂–¥–æ–º –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—å –Ω–∞ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —ç–∫–∑–µ–º–ø–ª—è—Ä –ò–º–µ–Ω–∏ ), –∏ –ø—Ä–∏ —ç—Ç–æ–º –Ω–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∏—Ö –ø–æ–≤–µ–¥–µ–Ω–∏–∏ –∏–ª–∏ —Å–ø–æ—Å–æ–±–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è.
    –¢–æ –µ—Å—Ç—å, –æ–Ω–∏ –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –ø–æ–∫–∞ —É –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è –∏–º—è.
    –¢–æ–≥–¥–∞ —Ç–∞–∫ –∂–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è –∏–º—è –∏ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞!
    –ß—Ç–æ–±—ã —ç—Ç–æ–≥–æ –∏–∑–±–µ–∂–∞—Ç—å –∏ —Å–¥–µ–ª–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º, –µ–≥–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–º –¥–ª—è –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–Ω–∞—á–µ –∫–∞–∫ –ø—É—Ç–µ–º –ø–æ–ª–Ω–æ–π –∑–∞–º–µ–Ω—ã. 

    –¢–∞ –∂–µ –ø—Ä–æ–±–ª–µ–º–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –æ–±—ä–µ–∫—Ç –ø–µ—Ä–µ–¥–∞–µ—Ç –æ–¥–∏–Ω –∏–∑ —Å–≤–æ–∏—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –¥—Ä—É–≥–æ–º—É –æ–±—ä–µ–∫—Ç—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ –∏–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.
    –°–æ —Å—Ç—Ä–∞–Ω—Å—Ç–≤—É—é—â–∏–º –æ–±—ä–µ–∫—Ç–æ–º –º–æ–∂–µ—Ç —Å–ª—É—á–∏—Ç—å—Å—è –≤—Å–µ, —á—Ç–æ —É–≥–æ–¥–Ω–æ, –∑–∞ —Ç–æ –≤—Ä–µ–º—è, –ø–æ–∫–∞ –æ–Ω –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –≤–ª–∞–¥–µ–ª—å—Ü–∞.
    3–ù–ê–ß–ï–ù–ò–ï (VALUE) –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –±—É–¥–µ—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω –∏ –æ–±—ä–µ–∫—Ç-–≤–ª–∞–¥–µ–ª–µ—Ü –ø—É—Ç–µ–º –∏—Å–∫–∞–∂–µ–Ω–∏—è –µ–≥–æ –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç–æ–≤.
    –ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —ç—Ç–æ–≥–æ, –ø–µ—Ä–µ–¥–∞–≤–∞–µ–º—ã–π –æ–±—ä–µ–∫—Ç –¥–µ–ª–∞—é—Ç –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º –∏–ª–∏ –∂–µ –ø–µ—Ä–µ–¥–∞—é—Ç –µ–≥–æ –ö–û–ü–ò–Æ.

    In fact, the two Person objects might not need their own name instances.
    The same Name object could be shared between the two Person objects (each with a pointer to the same name instance) with no change in their behavior or identity.
    That is, their behavior will be correct until some change is made to the name of one person. Then the other person's name would change also!
    To protect against this, in order for an object to be shared safely, it must be immutable: it cannot be changed except by full replacement. 

    The same issues arise when an object passes one of its attributes to another object as an argument or return value.
    Anything could happen to the wandering object while it is out of control of its owner.
    The VALUE could be changed in a way that corrupts the owner, by violating the owner's invariants.
    This problem is avoided either by making the passed object immutable, or by passing a copy.

    -- "Domain-Driven Design: Tackling Complexity in the Heart of Software" by Eric Evans, –ø–µ—Ä–µ–≤–æ–¥ –í.–õ. –ë—Ä–æ–¥–æ–≤–æ–≥–æ
